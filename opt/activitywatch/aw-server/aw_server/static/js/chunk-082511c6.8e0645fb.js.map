{"version":3,"sources":["webpack:///./src/visualizations/PeriodUsage.vue?4d4c","webpack:///./src/visualizations/periodusage.js","webpack:///src/visualizations/PeriodUsage.vue","webpack:///./src/visualizations/PeriodUsage.vue?b665","webpack:///./src/visualizations/PeriodUsage.vue?e4bb","webpack:///./src/visualizations/PeriodUsage.vue?7dc5"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticRenderFns","d3","require","_","moment","create","svg_elem","innerHTML","set_status","msg","svg","select","append","attr","text","diagramcolor","diagramcolor_selected","diagramcolor_focused","update","usage_arr","onPeriodClicked","dateformat","length","usage_times","map","day_events","get_usage_time","longest_usage","Math","max","apply","padding","width","center_elem","floor","each","events","i","usage_time","height","date","timestamp","format","color","offset","x","isSame","rect","style","on","d","j","n","a","getAttribute","seconds_to_duration","day_event","head","filter","e","data","status","undefined","duration","name","props","periodusage_arr","type","Array","watch","periodusage","$el","mounted","methods","$emit","period","component"],"mappings":"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","file":"js/chunk-082511c6.8e0645fb.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('svg')}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","'use strict';\n\nconst d3 = require('d3');\nconst _ = require('lodash');\nconst moment = require('moment');\n\nimport { seconds_to_duration } from '../util/time.js';\n\nfunction create(svg_elem) {\n  // Clear element\n  svg_elem.innerHTML = '';\n}\n\nfunction set_status(svg_elem, msg) {\n  // Select svg canvas\n  svg_elem.innerHTML = '';\n  const svg = d3.select(svg_elem);\n\n  svg\n    .append('text')\n    .attr('x', '5pt')\n    .attr('y', '25pt')\n    .text(msg)\n    .attr('font-family', 'sans-serif')\n    .attr('font-size', '20pt')\n    .attr('fill', 'black');\n}\n\nconst diagramcolor = '#aaa';\nconst diagramcolor_selected = '#fc5';\nconst diagramcolor_focused = '#adf';\n\nfunction update(svg_elem, usage_arr, onPeriodClicked) {\n  const dateformat = 'YYYY-MM-DD';\n\n  // No apps, sets status to \"No data\"\n  if (usage_arr.length <= 0) {\n    set_status(svg_elem, 'No data');\n    return;\n  }\n  svg_elem.innerHTML = '';\n  const svg = d3.select(svg_elem);\n\n  function get_usage_time(day_events) {\n    const day_event = _.head(_.filter(day_events, e => e.data.status == 'not-afk'));\n    return day_event != undefined ? day_event.duration : 0;\n  }\n\n  const usage_times = usage_arr.map(day_events => get_usage_time(day_events));\n  let longest_usage = Math.max.apply(null, usage_times);\n  // Avoid division by zero\n  if (longest_usage <= 0) {\n    longest_usage = 0.00000000001;\n  }\n\n  const padding = 0.3 * (100 / (usage_arr.length - 1));\n  const width = 100 / usage_arr.length - padding;\n  const center_elem = Math.floor(usage_arr.length / 2);\n\n  _.each(usage_arr, (events, i) => {\n    const usage_time = get_usage_time(events);\n    const height = 85 * (usage_time / longest_usage);\n    let date = '';\n    if (events.length > 0) {\n      // slice off so it's only the day\n      date = moment(usage_arr[i][0].timestamp).format(dateformat);\n    }\n    const color = i == center_elem ? diagramcolor_selected : diagramcolor;\n    const offset = 50;\n\n    const x = i * padding + i * width + 0.25 * width;\n\n    if (moment(date).isSame(moment(), 'day')) {\n      svg\n        .append('line')\n        .attr('x1', x + width / 2 + '%')\n        .attr('y1', 0)\n        .attr('x2', x + width / 2 + '%')\n        .attr('y2', 200)\n        .attr('style', 'stroke: #888; stroke-width: 2px;')\n        .attr('stroke-dasharray', '4, 2');\n\n      svg\n        .append('text')\n        .attr('x', x + 1.5 * width + '%')\n        .attr('y', '30')\n        .text('Today');\n    }\n\n    const rect = svg\n      .append('rect')\n      .attr('x', x + '%')\n      .attr('y', 101 - height + '%') // Draw rect bottom-up\n      .attr('rx', 3)\n      .attr('ry', 3)\n      .attr(\n        'style',\n        i == center_elem ? 'stroke: black; stroke-width: 1;' : 'stroke: #222; stroke-width: 1;'\n      )\n      .attr('width', width + '%')\n      .attr('height', height + offset + '%')\n      .attr('color', color)\n      .attr('date', date)\n      .style('fill', color)\n      .on('mouseover', () => {\n        rect.style('fill', diagramcolor_focused);\n      })\n      .on('mouseout', (d, j, n) => {\n        const a = n[j];\n        rect.style('fill', a.getAttribute('color'));\n      })\n      .on('click', function () {\n        onPeriodClicked(date);\n      });\n    rect\n      .append('title')\n      .text(moment(date).format(dateformat) + '\\n' + seconds_to_duration(usage_time));\n  });\n}\n\nexport default {\n  create: create,\n  update: update,\n  set_status: set_status,\n};\n","<template lang=\"pug\">\nsvg\n</template>\n\n<style scoped lang=\"scss\">\nsvg {\n  width: 100%;\n  height: 40pt;\n  border: 1px solid #999;\n  margin-top: 0.2em;\n  margin-bottom: 0.2em;\n  border-radius: 0.5em;\n}\n</style>\n\n<script>\n// NOTE: This is just a Vue.js component wrapper for periodusage.js\n//       Code should generally go in the framework-independent file.\n\nimport periodusage from './periodusage.js';\n\nexport default {\n  name: 'aw-periodusage',\n  props: {\n    periodusage_arr: {\n      type: Array,\n    },\n  },\n  watch: {\n    periodusage_arr: function () {\n      periodusage.update(this.$el, this.periodusage_arr, this.onPeriodClicked);\n    },\n  },\n  mounted: function () {\n    periodusage.create(this.$el);\n    periodusage.set_status(this.$el, 'Loading...');\n  },\n  methods: {\n    onPeriodClicked: function (period) {\n      this.$emit('update', period);\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PeriodUsage.vue?vue&type=template&id=61c0ca23&scoped=true&lang=pug&\"\nimport script from \"./PeriodUsage.vue?vue&type=script&lang=js&\"\nexport * from \"./PeriodUsage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PeriodUsage.vue?vue&type=style&index=0&id=61c0ca23&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"61c0ca23\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=style&index=0&id=61c0ca23&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--7-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PeriodUsage.vue?vue&type=style&index=0&id=61c0ca23&scoped=true&lang=scss&\""],"sourceRoot":""}