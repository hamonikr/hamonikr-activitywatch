{"version":3,"sources":["webpack:///./node_modules/vue-awesome/icons/regular/minus-square.js","webpack:///./node_modules/vue-awesome/icons/circle.js","webpack:///./node_modules/vue-awesome/icons/regular/plus-square.js","webpack:///./src/visualizations/CategoryTree.vue?8543","webpack:///src/visualizations/CategoryTree.vue","webpack:///./src/visualizations/CategoryTree.vue?1603","webpack:///./src/visualizations/CategoryTree.vue"],"names":["register","width","height","paths","d","circle","render","_vm","this","_h","$createElement","_c","_self","staticStyle","_l","cat","parents_expanded","on","$event","toggle","style","depth","children","length","expanded","has","name_pretty","staticClass","attrs","_v","_s","subname","Math","round","duration","total_duration","_f","_e","model","value","callback","$$v","show_perc","expression","staticRenderFns","_get_child_cats","all_cats","_","filter","_assign_children","parent","map","child_cats","sortBy","_flatten_hierarchy","c","flattenDeep","name","props","events","data","Set","computed","sumBy","top_c","category_hierarchy","cats_with_depth0","cats","flatten","methods","get_category","find","add","undefined","component"],"mappings":"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","file":"js/chunk-895b8e12.5ce208bf.js","sourcesContent":["import Icon from '../../components/Icon.vue'\n\nIcon.register({\n  'regular/minus-square': {\n    width: 448,\n    height: 512,\n    paths: [\n      {\n        d: 'M108 284c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h232c6.6 0 12 5.4 12 12v32c0 6.6-5.4 12-12 12h-232zM448 80v352c0 26.5-21.5 48-48 48h-352c-26.5 0-48-21.5-48-48v-352c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zM400 426v-340c0-3.3-2.7-6-6-6h-340c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z'\n      }\n    ]\n  }\n})\n","import Icon from '../components/Icon.vue'\n\nIcon.register({\n  circle: {\n    width: 512,\n    height: 512,\n    paths: [\n      {\n        d: 'M256 8c137 0 248 111 248 248s-111 248-248 248-248-111-248-248 111-248 248-248z'\n      }\n    ]\n  }\n})\n","import Icon from '../../components/Icon.vue'\n\nIcon.register({\n  'regular/plus-square': {\n    width: 448,\n    height: 512,\n    paths: [\n      {\n        d: 'M352 240v32c0 6.6-5.4 12-12 12h-88v88c0 6.6-5.4 12-12 12h-32c-6.6 0-12-5.4-12-12v-88h-88c-6.6 0-12-5.4-12-12v-32c0-6.6 5.4-12 12-12h88v-88c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v88h88c6.6 0 12 5.4 12 12zM448 80v352c0 26.5-21.5 48-48 48h-352c-26.5 0-48-21.5-48-48v-352c0-26.5 21.5-48 48-48h352c26.5 0 48 21.5 48 48zM400 426v-340c0-3.3-2.7-6-6-6h-340c-3.3 0-6 2.7-6 6v340c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z'\n      }\n    ]\n  }\n})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"font-size\":\"0.9em\"}},[_vm._l((_vm.category_hierarchy),function(cat){return (_vm.parents_expanded(cat))?_c('div',{staticStyle:{\"padding\":\"0.1em 0 0.1em 0\"},on:{\"click\":function($event){return _vm.toggle(cat)}}},[_c('span',{style:('padding-left: ' + (1.4 * cat.depth) + 'em')},[(cat.children.length > 0)?_c('span',{staticStyle:{\"opacity\":\"0.8\"}},[(!_vm.expanded.has(cat.name_pretty))?_c('b',[_c('icon',{staticClass:\"mr-1\",attrs:{\"name\":\"regular/plus-square\",\"scale\":\"0.8\"}})],1):_c('b',[_c('icon',{staticClass:\"mr-1\",attrs:{\"name\":\"regular/minus-square\",\"scale\":\"0.8\"}})],1)]):_c('span',{staticStyle:{\"opacity\":\"0.6\"}},[_c('icon',{staticStyle:{\"margin-left\":\"1em\",\"margin-right\":\"1.22em\"},attrs:{\"name\":\"circle\",\"scale\":\"0.4\"}})],1),_vm._v(_vm._s(cat.subname))]),_c('span',{staticStyle:{\"float\":\"right\"}},[(_vm.show_perc)?_c('span',[_vm._v(_vm._s(Math.round(100 * cat.duration / _vm.total_duration, 1))+\"%\")]):_c('span',[_vm._v(_vm._s(_vm._f(\"friendlyduration\")(cat.duration)))])])]):_vm._e()}),_c('hr'),_c('b-checkbox',{attrs:{\"size\":\"sm\"},model:{value:(_vm.show_perc),callback:function ($$v) {_vm.show_perc=$$v},expression:\"show_perc\"}},[_vm._v(\"Show percent\")])],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\ndiv(style=\"font-size: 0.9em\")\n  div(v-for=\"cat in category_hierarchy\", style=\"padding: 0.1em 0 0.1em 0\" @click=\"toggle(cat)\" v-if=\"parents_expanded(cat)\")\n    span(:style=\"'padding-left: ' + (1.4 * cat.depth) + 'em'\")\n\n      // icon\n      span(v-if=\"cat.children.length > 0\", style=\"opacity: 0.8\")\n        b(v-if=\"!expanded.has(cat.name_pretty)\")\n          icon.mr-1(name=\"regular/plus-square\", scale=\"0.8\")\n        b(v-else)\n          icon.mr-1(name=\"regular/minus-square\", scale=\"0.8\")\n      span(v-else, style=\"opacity: 0.6\")\n        icon(name=\"circle\", scale=\"0.4\", style=\"margin-left: 1em; margin-right: 1.22em;\")\n\n      // title\n      | {{cat.subname}}\n\n    // time\n    span(style=\"float: right\")\n      span(v-if=\"show_perc\")\n        | {{Math.round(100 * cat.duration / total_duration, 1)}}%\n      span(v-else)\n        | {{cat.duration | friendlyduration}}\n  hr\n  // TODO: Make configurable in a cleaner way (figure out a way to configure visualizations generally)\n  b-checkbox(v-model=\"show_perc\" size=\"sm\") Show percent\n</template>\n\n<script>\nimport 'vue-awesome/icons/circle';\nimport 'vue-awesome/icons/regular/plus-square';\nimport 'vue-awesome/icons/regular/minus-square';\nconst _ = require('lodash');\nconst classes = require('~/util/classes.ts');\n\nfunction _get_child_cats(cat, all_cats) {\n  return _.filter(all_cats, c => _.isEqual(c.parent, cat.name));\n}\n\nfunction _assign_children(parent, all_cats) {\n  const child_cats = _get_child_cats(parent, all_cats);\n  // Recurse\n  _.map(child_cats, c => _assign_children(c, all_cats));\n  parent.children = _.sortBy(child_cats, cc => -cc.duration);\n}\n\n// Flattens the category hierarchy\nfunction _flatten_hierarchy(c) {\n  if (!c.children) return [];\n  return _.flattenDeep([c, _.map(c.children, cc => _flatten_hierarchy(cc))]);\n}\n\nexport default {\n  name: 'aw-categorytree',\n  props: {\n    events: { type: Array },\n  },\n  data: function () {\n    return {\n      expanded: new Set(),\n      show_perc: false,\n    };\n  },\n  computed: {\n    total_duration: function () {\n      // sum top-level categories\n      const top_c = _.filter(this.category_hierarchy, c => c.depth == 0);\n      return _.sumBy(top_c, c => c.duration);\n    },\n    category_hierarchy: function () {\n      const events = JSON.parse(JSON.stringify(this.events));\n\n      const hier = classes.build_category_hierarchy(\n        _.map(events, e => {\n          return { name: e.data['$category'] };\n        })\n      );\n\n      let cats = classes.flatten_category_hierarchy(hier).map(c => {\n        c.duration = _.sumBy(\n          events.filter(e => {\n            const pcat = e.data['$category'].slice(0, c.name.length);\n            return _.isEqual(c.name, pcat);\n          }),\n          e => e.duration\n        );\n        return c;\n      });\n\n      const cats_with_depth0 = _.sortBy(\n        _.filter(cats, c => c.depth == 0),\n        c => -c.duration\n      );\n      _.map(cats_with_depth0, c => _assign_children(c, cats));\n\n      cats = _.flatten(_.map(cats_with_depth0, c => _flatten_hierarchy(c)));\n      //console.log(cats);\n      // TODO: If a category has children, but also activity attributed directly to the parent that does not belong to a child, then create a \"Other\" child containing the activity.\n      return cats;\n    },\n  },\n  methods: {\n    get_category: function (cat_arr) {\n      return _.find(this.category_hierarchy, c => _.isEqual(c.name, cat_arr));\n    },\n    toggle: function (cat) {\n      if (this.expanded.has(cat.name_pretty)) {\n        this.expanded.delete(cat.name_pretty);\n      } else {\n        this.expanded.add(cat.name_pretty);\n      }\n      // needed to trigger update, since Set isn't reactive in Vue 2\n      this.expanded = new Set(this.expanded);\n    },\n    parents_expanded: function (cat) {\n      if (cat === undefined || !cat.parent) {\n        // top-level category\n        return true;\n      }\n      return (\n        // Check grandparents recursively\n        this.parents_expanded(this.get_category(cat.parent)) &&\n        // Check parent\n        this.expanded.has(cat.parent.join('>'))\n      );\n    },\n  },\n};\n</script>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryTree.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--11-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./CategoryTree.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CategoryTree.vue?vue&type=template&id=2d1b41db&lang=pug&\"\nimport script from \"./CategoryTree.vue?vue&type=script&lang=js&\"\nexport * from \"./CategoryTree.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}